<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/backend/layers/telemetry/main.ts">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/backend/layers/telemetry/main.ts" />
              <option name="originalContent" value="import { Logger } from '@aws-lambda-powertools/logger';&#10;import { injectLambdaContext } from '@aws-lambda-powertools/logger/middleware';&#10;import { Metrics } from '@aws-lambda-powertools/metrics';&#10;import { logMetrics } from '@aws-lambda-powertools/metrics/middleware';&#10;import { Tracer } from '@aws-lambda-powertools/tracer';&#10;import { captureLambdaHandler } from '@aws-lambda-powertools/tracer/middleware';&#10;&#10;&#10;import type { TelemetryTools } from './TelemetryTools';&#10;&#10;/**&#10; * Get instances of all the _telemetry tools we use.&#10; * @param serviceName Service name of Telemetry&#10; * @param namespace Namespace of Telemetry&#10; */&#10;export const getTelemetryTools = (serviceName: string, namespace: string): TelemetryTools =&gt; {&#10;    const tracer = new Tracer({ serviceName });&#10;    const logger = new Logger({ serviceName, logLevel: getLogLevel() });&#10;    const metrics = new Metrics({ serviceName, namespace });&#10;&#10;    return { tracer, logger, metrics };&#10;};&#10;&#10;/**&#10; * Returns an array of the default Middy middlewares that we use.&#10; */&#10;export const telemetryMiddleware = ({ logger, tracer, metrics }: TelemetryTools) =&gt; {&#10;    return [&#10;        captureLambdaHandler(tracer),&#10;        injectLambdaContext(logger),&#10;        logMetrics(metrics, { captureColdStartMetric: true }),&#10;    ];&#10;};&#10;&#10;const getLogLevel = () =&gt; {&#10;    if (NodeEnv.isDevelopment()) {&#10;        return 'DEBUG';&#10;    }&#10;    if (NodeEnv.isProduction()) {&#10;        return 'INFO';&#10;    }&#10;&#10;    if (NodeEnv.isQa()) {&#10;        return 'DEBUG';&#10;    }&#10;&#10;&#10;    return 'INFO';&#10;};&#10;" />
              <option name="updatedContent" value="import { Logger } from '@aws-lambda-powertools/logger';&#10;import { injectLambdaContext } from '@aws-lambda-powertools/logger/middleware';&#10;import { Metrics } from '@aws-lambda-powertools/metrics';&#10;import { logMetrics } from '@aws-lambda-powertools/metrics/middleware';&#10;import { Tracer } from '@aws-lambda-powertools/tracer';&#10;import { captureLambdaHandler } from '@aws-lambda-powertools/tracer/middleware';&#10;&#10;&#10;import type { TelemetryTools } from './TelemetryTools';&#10;&#10;/**&#10; * Get instances of all the _telemetry tools we use.&#10; * @param serviceName Service name of Telemetry&#10; * @param namespace Namespace of Telemetry&#10; */&#10;export const getTelemetryTools = (serviceName: string, namespace: string): TelemetryTools =&gt; {&#10;    const tracer = new Tracer({ serviceName });&#10;    const logger = new Logger({ serviceName, logLevel: getLogLevel() });&#10;    const metrics = new Metrics({ serviceName, namespace });&#10;&#10;    return { tracer, logger, metrics };&#10;};&#10;&#10;/**&#10; * Returns an array of the default Middy middlewares that we use.&#10; */&#10;export const telemetryMiddleware = ({ logger, tracer, metrics }: TelemetryTools) =&gt; {&#10;    return [&#10;        captureLambdaHandler(tracer),&#10;        injectLambdaContext(logger),&#10;        logMetrics(metrics, { captureColdStartMetric: true }),&#10;    ];&#10;};&#10;&#10;const getLogLevel = () =&gt; {&#10;    if (NodeEnv.isDevelopment()) {&#10;        return 'DEBUG';&#10;    }&#10;    if (NodeEnv.isProduction()) {&#10;        return 'INFO';&#10;    }&#10;&#10;    if (NodeEnv.isQa()) {&#10;        return 'DEBUG';&#10;    }&#10;&#10;&#10;    return 'INFO';&#10;};&#10;&#10;// Export getLogLevel if needed externally&#10;export { getLogLevel };&#10;&#10;// No Lambda handler code here; only utilities for use in Lambda functions" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/front-end/src/app/auth/forgot-password/page.tsx">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/front-end/src/app/auth/forgot-password/page.tsx" />
              <option name="updatedContent" value="'use client';&#10;&#10;import { useState } from 'react';&#10;import { useRouter } from 'next/navigation';&#10;import ForgotPasswordForm from '@/components/auth/ForgotPasswordForm';&#10;import ResetPasswordForm from '@/components/auth/ResetPasswordForm';&#10;&#10;export default function ForgotPasswordPage() {&#10;  const [step, setStep] = useState&lt;'request' | 'reset'&gt;('request');&#10;  const [email, setEmail] = useState('');&#10;  const router = useRouter();&#10;&#10;  const handleRequestSuccess = (userEmail: string) =&gt; {&#10;    setEmail(userEmail);&#10;    setStep('reset');&#10;  };&#10;&#10;  const handleResetSuccess = () =&gt; {&#10;    router.push('/auth/login?message=Password reset successfully');&#10;  };&#10;&#10;  return (&#10;    &lt;div className=&quot;min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8&quot;&gt;&#10;      {step === 'request' ? (&#10;        &lt;ForgotPasswordForm onSuccess={handleRequestSuccess} /&gt;&#10;      ) : (&#10;        &lt;ResetPasswordForm email={email} onSuccess={handleResetSuccess} /&gt;&#10;      )}&#10;    &lt;/div&gt;&#10;  );&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/front-end/src/app/auth/register/page.tsx">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/front-end/src/app/auth/register/page.tsx" />
              <option name="updatedContent" value="'use client';&#10;&#10;import { useState } from 'react';&#10;import { useRouter } from 'next/navigation';&#10;import RegisterForm from '@/components/auth/RegisterForm';&#10;import ConfirmSignUpForm from '@/components/auth/ConfirmSignUpForm';&#10;&#10;export default function RegisterPage() {&#10;  const [step, setStep] = useState&lt;'register' | 'confirm'&gt;('register');&#10;  const [email, setEmail] = useState('');&#10;  const router = useRouter();&#10;&#10;  const handleRegisterSuccess = (userEmail: string) =&gt; {&#10;    setEmail(userEmail);&#10;    setStep('confirm');&#10;  };&#10;&#10;  const handleConfirmSuccess = () =&gt; {&#10;    router.push('/auth/login?message=Account confirmed successfully');&#10;  };&#10;&#10;  return (&#10;    &lt;div className=&quot;min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8&quot;&gt;&#10;      {step === 'register' ? (&#10;        &lt;RegisterForm onSuccess={handleRegisterSuccess} /&gt;&#10;      ) : (&#10;        &lt;ConfirmSignUpForm email={email} onSuccess={handleConfirmSuccess} /&gt;&#10;      )}&#10;    &lt;/div&gt;&#10;  );&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/front-end/src/app/layout.tsx">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/front-end/src/app/layout.tsx" />
              <option name="originalContent" value="import type { Metadata } from &quot;next&quot;;&#10;import { Geist, Geist_Mono } from &quot;next/font/google&quot;;&#10;import &quot;./globals.css&quot;;&#10;&#10;const geistSans = Geist({&#10;  variable: &quot;--font-geist-sans&quot;,&#10;  subsets: [&quot;latin&quot;],&#10;});&#10;&#10;const geistMono = Geist_Mono({&#10;  variable: &quot;--font-geist-mono&quot;,&#10;  subsets: [&quot;latin&quot;],&#10;});&#10;&#10;export const metadata: Metadata = {&#10;  title: &quot;Create Next App&quot;,&#10;  description: &quot;Generated by create next app&quot;,&#10;};&#10;&#10;export default function RootLayout({&#10;  children,&#10;}: Readonly&lt;{&#10;  children: React.ReactNode;&#10;}&gt;) {&#10;  return (&#10;    &lt;html lang=&quot;en&quot;&gt;&#10;      &lt;body&#10;        className={`${geistSans.variable} ${geistMono.variable} antialiased`}&#10;      &gt;&#10;        {children}&#10;      &lt;/body&gt;&#10;    &lt;/html&gt;&#10;  );&#10;}&#10;" />
              <option name="updatedContent" value="import type { Metadata } from &quot;next&quot;;&#10;import { Geist, Geist_Mono } from &quot;next/font/google&quot;;&#10;import &quot;./globals.css&quot;;&#10;import { AuthProvider } from &quot;@/contexts/AuthContext&quot;;&#10;&#10;const geistSans = Geist({&#10;  variable: &quot;--font-geist-sans&quot;,&#10;  subsets: [&quot;latin&quot;],&#10;});&#10;&#10;const geistMono = Geist_Mono({&#10;  variable: &quot;--font-geist-mono&quot;,&#10;  subsets: [&quot;latin&quot;],&#10;});&#10;&#10;export const metadata: Metadata = {&#10;  title: &quot;Todo App&quot;,&#10;  description: &quot;Modern todo application with authentication&quot;,&#10;};&#10;&#10;export default function RootLayout({&#10;  children,&#10;}: Readonly&lt;{&#10;  children: React.ReactNode;&#10;}&gt;) {&#10;  return (&#10;    &lt;html lang=&quot;en&quot;&gt;&#10;      &lt;body&#10;        className={`${geistSans.variable} ${geistMono.variable} antialiased`}&#10;      &gt;&#10;        &lt;AuthProvider&gt;&#10;          {children}&#10;        &lt;/AuthProvider&gt;&#10;      &lt;/body&gt;&#10;    &lt;/html&gt;&#10;  );&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/front-end/src/components/auth/ConfirmSignUpForm.tsx">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/front-end/src/components/auth/ConfirmSignUpForm.tsx" />
              <option name="updatedContent" value="'use client';&#10;&#10;import React from 'react';&#10;import Link from 'next/link';&#10;import { useForm } from 'react-hook-form';&#10;import { zodResolver } from '@hookform/resolvers/zod';&#10;import { Hash, AlertCircle, Mail, CheckCircle } from 'lucide-react';&#10;import { confirmSignUpSchema, ConfirmSignUpFormData } from '@/lib/validation';&#10;import { useAuthActions } from '@/hooks/useAuthActions';&#10;&#10;interface ConfirmSignUpFormProps {&#10;  email?: string;&#10;  onSuccess?: () =&gt; void;&#10;}&#10;&#10;export default function ConfirmSignUpForm({ email, onSuccess }: ConfirmSignUpFormProps) {&#10;  const { handleConfirmSignUp, loading, error, clearError } = useAuthActions();&#10;&#10;  const {&#10;    register,&#10;    handleSubmit,&#10;    formState: { errors, isSubmitting },&#10;  } = useForm&lt;ConfirmSignUpFormData&gt;({&#10;    resolver: zodResolver(confirmSignUpSchema),&#10;    defaultValues: {&#10;      email: email || '',&#10;    },&#10;  });&#10;&#10;  const onSubmit = async (data: ConfirmSignUpFormData) =&gt; {&#10;    clearError();&#10;    const success = await handleConfirmSignUp(data.email, data.code);&#10;    if (success &amp;&amp; onSuccess) {&#10;      onSuccess();&#10;    }&#10;  };&#10;&#10;  return (&#10;    &lt;div className=&quot;w-full max-w-md mx-auto&quot;&gt;&#10;      &lt;div className=&quot;bg-white shadow-xl rounded-lg p-8&quot;&gt;&#10;        &lt;div className=&quot;text-center mb-8&quot;&gt;&#10;          &lt;div className=&quot;mx-auto w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mb-4&quot;&gt;&#10;            &lt;Mail className=&quot;h-8 w-8 text-blue-600&quot; /&gt;&#10;          &lt;/div&gt;&#10;          &lt;h1 className=&quot;text-3xl font-bold text-gray-900&quot;&gt;Verify Your Email&lt;/h1&gt;&#10;          &lt;p className=&quot;text-gray-600 mt-2&quot;&gt;&#10;            We've sent a verification code to {email || 'your email'}&#10;          &lt;/p&gt;&#10;        &lt;/div&gt;&#10;&#10;        {error &amp;&amp; (&#10;          &lt;div className=&quot;mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3&quot;&gt;&#10;            &lt;AlertCircle className=&quot;h-5 w-5 text-red-500 flex-shrink-0&quot; /&gt;&#10;            &lt;div className=&quot;text-sm text-red-700&quot;&gt;&#10;              &lt;p className=&quot;font-medium&quot;&gt;Verification failed&lt;/p&gt;&#10;              &lt;p&gt;{error.message}&lt;/p&gt;&#10;            &lt;/div&gt;&#10;          &lt;/div&gt;&#10;        )}&#10;&#10;        &lt;form onSubmit={handleSubmit(onSubmit)} className=&quot;space-y-6&quot;&gt;&#10;          {!email &amp;&amp; (&#10;            &lt;div&gt;&#10;              &lt;label htmlFor=&quot;email&quot; className=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;&#10;                Email Address&#10;              &lt;/label&gt;&#10;              &lt;div className=&quot;relative&quot;&gt;&#10;                &lt;div className=&quot;absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none&quot;&gt;&#10;                  &lt;Mail className=&quot;h-5 w-5 text-gray-400&quot; /&gt;&#10;                &lt;/div&gt;&#10;                &lt;input&#10;                  {...register('email')}&#10;                  type=&quot;email&quot;&#10;                  className=&quot;block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent&quot;&#10;                  placeholder=&quot;Enter your email&quot;&#10;                /&gt;&#10;              &lt;/div&gt;&#10;              {errors.email &amp;&amp; (&#10;                &lt;p className=&quot;mt-1 text-sm text-red-600&quot;&gt;{errors.email.message}&lt;/p&gt;&#10;              )}&#10;            &lt;/div&gt;&#10;          )}&#10;&#10;          &lt;div&gt;&#10;            &lt;label htmlFor=&quot;code&quot; className=&quot;block text-sm font-medium text-gray-700 mb-2&quot;&gt;&#10;              Verification Code&#10;            &lt;/label&gt;&#10;            &lt;div className=&quot;relative&quot;&gt;&#10;              &lt;div className=&quot;absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none&quot;&gt;&#10;                &lt;Hash className=&quot;h-5 w-5 text-gray-400&quot; /&gt;&#10;              &lt;/div&gt;&#10;              &lt;input&#10;                {...register('code')}&#10;                type=&quot;text&quot;&#10;                maxLength={6}&#10;                className=&quot;block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center text-lg tracking-widest&quot;&#10;                placeholder=&quot;000000&quot;&#10;              /&gt;&#10;            &lt;/div&gt;&#10;            {errors.code &amp;&amp; (&#10;              &lt;p className=&quot;mt-1 text-sm text-red-600&quot;&gt;{errors.code.message}&lt;/p&gt;&#10;            )}&#10;          &lt;/div&gt;&#10;&#10;          &lt;button&#10;            type=&quot;submit&quot;&#10;            disabled={loading || isSubmitting}&#10;            className=&quot;w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors&quot;&#10;          &gt;&#10;            {loading || isSubmitting ? 'Verifying...' : 'Verify Email'}&#10;          &lt;/button&gt;&#10;        &lt;/form&gt;&#10;&#10;        &lt;div className=&quot;mt-8 text-center space-y-4&quot;&gt;&#10;          &lt;p className=&quot;text-sm text-gray-600&quot;&gt;&#10;            Didn't receive the code?{' '}&#10;            &lt;button&#10;              type=&quot;button&quot;&#10;              className=&quot;text-blue-600 hover:text-blue-500 font-medium&quot;&#10;            &gt;&#10;              Resend Code&#10;            &lt;/button&gt;&#10;          &lt;/p&gt;&#10;          &#10;          &lt;Link&#10;            href=&quot;/auth/register&quot;&#10;            className=&quot;block text-sm text-blue-600 hover:text-blue-500 font-medium&quot;&#10;          &gt;&#10;            Use different email&#10;          &lt;/Link&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;  );&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/front-end/src/hooks/useAuthActions.ts">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/front-end/src/hooks/useAuthActions.ts" />
              <option name="updatedContent" value="'use client';&#10;&#10;import { useState } from 'react';&#10;import { signIn, signUp, confirmSignUp, resetPassword, confirmResetPassword } from 'aws-amplify/auth';&#10;import { useAuth } from '@/contexts/AuthContext';&#10;import type { &#10;  LoginCredentials, &#10;  RegisterCredentials, &#10;  ForgotPasswordData, &#10;  ResetPasswordData, &#10;  AuthError &#10;} from '@/types/auth';&#10;&#10;export function useAuthActions() {&#10;  const [loading, setLoading] = useState(false);&#10;  const [error, setError] = useState&lt;AuthError | null&gt;(null);&#10;  const { refreshAuth } = useAuth();&#10;&#10;  const clearError = () =&gt; setError(null);&#10;&#10;  const handleLogin = async (credentials: LoginCredentials): Promise&lt;boolean&gt; =&gt; {&#10;    setLoading(true);&#10;    setError(null);&#10;&#10;    try {&#10;      await signIn({&#10;        username: credentials.email,&#10;        password: credentials.password,&#10;      });&#10;      &#10;      await refreshAuth();&#10;      return true;&#10;    } catch (err: any) {&#10;      setError({&#10;        message: err.message || 'Failed to sign in',&#10;        code: err.name,&#10;      });&#10;      return false;&#10;    } finally {&#10;      setLoading(false);&#10;    }&#10;  };&#10;&#10;  const handleRegister = async (credentials: RegisterCredentials): Promise&lt;boolean&gt; =&gt; {&#10;    setLoading(true);&#10;    setError(null);&#10;&#10;    try {&#10;      await signUp({&#10;        username: credentials.email,&#10;        password: credentials.password,&#10;        options: {&#10;          userAttributes: {&#10;            email: credentials.email,&#10;          },&#10;        },&#10;      });&#10;      &#10;      return true;&#10;    } catch (err: any) {&#10;      setError({&#10;        message: err.message || 'Failed to create account',&#10;        code: err.name,&#10;      });&#10;      return false;&#10;    } finally {&#10;      setLoading(false);&#10;    }&#10;  };&#10;&#10;  const handleConfirmSignUp = async (email: string, code: string): Promise&lt;boolean&gt; =&gt; {&#10;    setLoading(true);&#10;    setError(null);&#10;&#10;    try {&#10;      await confirmSignUp({&#10;        username: email,&#10;        confirmationCode: code,&#10;      });&#10;      &#10;      return true;&#10;    } catch (err: any) {&#10;      setError({&#10;        message: err.message || 'Failed to confirm account',&#10;        code: err.name,&#10;      });&#10;      return false;&#10;    } finally {&#10;      setLoading(false);&#10;    }&#10;  };&#10;&#10;  const handleForgotPassword = async (data: ForgotPasswordData): Promise&lt;boolean&gt; =&gt; {&#10;    setLoading(true);&#10;    setError(null);&#10;&#10;    try {&#10;      await resetPassword({&#10;        username: data.email,&#10;      });&#10;      &#10;      return true;&#10;    } catch (err: any) {&#10;      setError({&#10;        message: err.message || 'Failed to send reset code',&#10;        code: err.name,&#10;      });&#10;      return false;&#10;    } finally {&#10;      setLoading(false);&#10;    }&#10;  };&#10;&#10;  const handleResetPassword = async (data: ResetPasswordData): Promise&lt;boolean&gt; =&gt; {&#10;    setLoading(true);&#10;    setError(null);&#10;&#10;    try {&#10;      await confirmResetPassword({&#10;        username: data.email,&#10;        confirmationCode: data.code,&#10;        newPassword: data.newPassword,&#10;      });&#10;      &#10;      return true;&#10;    } catch (err: any) {&#10;      setError({&#10;        message: err.message || 'Failed to reset password',&#10;        code: err.name,&#10;      });&#10;      return false;&#10;    } finally {&#10;      setLoading(false);&#10;    }&#10;  };&#10;&#10;  return {&#10;    loading,&#10;    error,&#10;    clearError,&#10;    handleLogin,&#10;    handleRegister,&#10;    handleConfirmSignUp,&#10;    handleForgotPassword,&#10;    handleResetPassword,&#10;  };&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>